\section{Матрицы}
\label{matrix}
%
%\epigraph{Errors using inadequate data are much less than those using no data at all.}{Charles Babbage}

\subsection{Основные понятия}

\begin{define}
  \emph{Матрица}\index{матрица} -- прямоугольная таблица из чисел или любых других объектов.
  $$
  A =
  \begin{pmatrix}
   a_{11}&a_{12}&\dots&a_{1n}\\
   a_{21}&a_{22}&\dots&a_{2n}\\
   \vdots&\vdots&\ddots&\vdots\\
   a_{n1}&a_{n2}&\dots&a_{mn}
  \end{pmatrix}
  $$
\end{define}

  Над матрицами определены следующие операции:
  \begin{enumerate}
    \item Умножение на скаляр.
    \item Транспонирование.\index{матрица!транспонированная} Cтроки записываются в столбцы. Обозначается $A^T$
    \item Сложение матриц. Определено только для матриц одинакового размера, производится почленное сложение всех элементов матрицы.
    \item Умножение матриц. Определяется следующим способом: пусть даны матрицы $A$ размером $m\times n$ и $B$ размером $n\times k$. Тогда матрица $C=AB$ будет состоять из элементов $c_{i_j}=\sum\limits_{k=1}^n a_{i_k}b_{k_j}$. %Определить таким образом умножение матриц было удобно исходя из определения скалярного произведения векторов.
  \end{enumerate}
  
  Так как матрицы являются обощением векторов, то операциям сложения и умножения на скаляр соответствуют все заявленные для векторов 8 свойств, некоторые другие свойства теории линейной зависимости также сохраняются.
  
  Можно также доказать следующие свойства, относящиеся к вновь определённым операциям:
  \begin{enumerate}
    \item $(A+B)^T = A^T+B^T$
    \item $(A+B)C=AC+BC$
    \item $A(BC)=(AB)C$
      {
      %\renewcommand\proofname{\quad\,\,$\blacktriangleright$\!}
      %\renewcommand\qedsymbol{$\blacktriangleleft$\!}      
      \begin{proof}
        Определим сначала базис пространства матриц $M_{m\times n}(\Rbb)$. Он будет состоять из \emph{матричных единиц}\index{матричная единица} $E_{ij}$ \emph{(на пересечении i-й строки и j-го столбца стоит 1, а все остальные элементы равны 0}. Всякая матрица будет представима в виде линейной комбинации матричных единиц.
        
        Теперь осталось проверить только ассоциативность умножения матричных единиц. В общем случае $$E_{ij}E_{kl}=\left\{\begin{array}{ll}E_{il},& k=j\\0,&k\ne j\end{array}\right..$$ Легко проверяется, что умножение матричных единиц ассоциативно. Из этого следует, что и умножение любых матриц ассоциативно, так как ранее мы доказали свойство дистрибутивности.
      \end{proof}
      }
    \item $(AB)^T=B^TA^T$
  \end{enumerate}
  
  \begin{define}
    \emph{Следом}\index{след матрицы} матрицы $\tr A$ называется сумма диагональных элементов матрицы. %Можно заметить, что для этой функции существует ряд очень интересных свойств, о которых, может быть, будет рассказано позднее.
  \end{define}
  
  Докажем следующее важное свойство: $\tr(AB)=\tr(BA)$:
  \begin{proof}
    Проведём доказательство одной строкой:
    
    $$\tr(AB)=\sum_i\sum_k a_{ik}b_{ki}=\sum_k\sum_i a_{ik}b_{ki}=\sum_k\sum_i b_{ki}a_{ik}=\tr(BA)$$%
  \end{proof}
  \begin{define}
  Единичной матрицей\index{матрица!единичная} называется такая матрица $E$, что $AE\bw=EA\bw=A$. Такая матрица имеет следующий вид (все элементы, кроме элементов главной диагонали, равны нулю):
  \begin{center}
  \scalebox{0.7}{
  $
  A =
  \begin{pmatrix}
   1&0&\dots&0\\
   0&1&\dots&0\\
   0&0&\ddots&\vdots\\
   0&0&\dots&1
  \end{pmatrix}
  $
  }
  \end{center}
  \end{define}
  
  \begin{define}
  Если в строке матрицы все элементы -- нули, то такая строка называется \emph{нулевой}. Первый ненулевой элемент в строке называется \emph{главным} или \emph{лидером}.
  \end{define}
  
  \begin{define}
  \emph{Элементарными преобразованиями (далее: ЭП) строк матрицы}\index{элементарные преобразования} называются преобразования вида:
  \begin{enumerate}
    \item К i-й строке прибавить j-ю, умноженную на $\lam\in\mathbb R$
    \item Поменять местами i-ю и j-ю строки
    \item Умножить i-ю строку на $\lam\ne0$
  \end{enumerate}
  Элементарные преобразования строк или столбцов матрицы можно записать как произведение исходной матрицы на одну из \emph{элементарных матриц}\index{элементарные матрицы} (прямых или транспонированных). Если матрицу умножить на одну из элементарных матриц слева ($A'=E_iA$), то соответствующее преобразование затронет строки, если справа -- столбцы.
  
  %\rotatebox{50}{text}
  
  \begin{center}
  \scalebox{0.75}{
  $
    E_1 =
  \begin{pmatrix}
   1&      & &       &       &      & \\
    &\ddots& &       &       &      & \\
    &      &1&\dots  &\lam   &\dots & \\
    &      & &\ddots &       &      & \\
    &      & &       &\ddots &      & \\
    &      & &       &       &1     &
  \end{pmatrix}\spc
  $
  }
  \scalebox{0.5}{
  $
  E_2 =
  \begin{pmatrix}
   1&      & &      & &      & &      & \\
    &\ddots& &      & &      & &      & \\
    &      &0&      & &      &1&      & \\
    &      & &\ddots& &      & &      & \\
    &      & &      &1&      & &      & \\
    &      & &      & &\ddots& &      & \\
    &      &1&      & &      &0&      & \\
    &      & &      & &      & &\ddots& \\
    &      & &      & &      & &     &1
  \end{pmatrix}
  \spc
  $
  }
  \scalebox{0.65}{
  $
    E_3 =
  \begin{pmatrix}
   1&      & &       & &      & \\
    &\ddots& &       & &      & \\
    &      &1&       & &      & \\
    &      & &\lam& &  &      & \\
    &      & &       &1&      & \\
    &      & &       & &\ddots& \\
    &      & &       & &      &1\\
  \end{pmatrix}
  $
  }
  \end{center}
\end{define}

  \newpage
  \begin{define}
    Матрица называется ступенчатой\index{матрица!ступенчатая}, если она удовлетворяет следующим условиям:
    \begin{enumerate}
     \item Ниже нулевой строки (если она есть) находятся только нулевые строки
     \item В каждой ненулевой строке её лидер стоит строго правее, чем в предыдущей.
    \end{enumerate}
  \begin{center}
  \scalebox{0.7}{
  $
  \tilde A' =
    \left(
  \begin{array}{c}
    \begin{array}{m{3mm}|m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}|m{3mm}}
       &*& . & . & . & . & . & .\\
     \cline{2-2}
    \end{array}\\
    \begin{array}{m{3mm}m{3mm}|m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}|m{3mm}}
       & & * & . & . & . & . & .\\
     \cline{3-4}
    \end{array}\\
    \begin{array}{m{3mm}m{3mm}m{3mm}m{3mm}|m{3mm}m{3mm}m{3mm}|m{3mm}}
       & &   &   & * & . & . & .\\
     \cline{5-8}
    \end{array}\\
    \begin{array}{m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}|m{3mm}}
       &0&   &   &   &   &   & .\\
    \end{array}\\
    \begin{array}{m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}m{3mm}|m{3mm}}
       & &   &   &   &   &   &  \\
    \end{array}\\
  \end{array}  
    \right)
  $
  }
  \end{center}
  \end{define}
  
  \begin{theorem}
    Любую матрицу можно привести к ступенчатому виду используя только ЭП 1 типа.
    \label{mat:echelon}
  \end{theorem}
  
  \begin{proof}
    Докажем теорему при помощи метода математической индукции. Индукцию проведём по количеству строк матрицы.
    
    Для $m = 1$ утверждение верно, так как матрица, состоящая из одной строки ступенчатая.
    
    Для удобства будем рассматривать матрицу без нулевых столбцов. Рассмотрим матрицу из m строк и её первую строку. Возможно две ситации:
    \begin{enumerate}
      \item $a_{11}\ne0$. Тогда с помощью ЭП 1 типа мы можем сделать все остальные элементы этого столбца нулевыми, добавив к каждой (i-й) строке этой матрицы первую, умноженную на $-\frac{a_{i1}}{a_{11}}$. 
      \item $a_{11}=0$. Так как мы исключили из рассмотрения все нулевые столбцы, то существует ненулевой элемент в первом столбце. Добавим к первой строке строку, содержащую этот элемент и реализуем алгоритм, описанный в пункте 1.
    \end{enumerate}
    
    По предположению индукции подматрицу этой матрицы из $m-1$ строки (со 2-й по последнюю) можно привести к ступенчатому виду, одновременно с этим и вся матрица приведётся к ступечатому виду. Теорема доказана.
  \end{proof}
  
  \begin{define}
    Матрица называется \emph{сильноступенчатой}\index{матрица!сильноступенчатая} (приведённой к улучшенному ступенчатому виду), если над лидерами её строк находятся только нулевые элементы, а сами лидеры равны 1. Сильноступенчатый вид матрицы единственен.
  \end{define}

Приведение матрицы к сильноступенчатому виду включено в алгоритм нахождения базиса любой системы векторов, а также нахождения ФСР ОСЛУ.
  
  %\begin{define}
  %  Обратной матрицей к $A$ называется такая матрица $A^{-1}$, что $AA^{-1}=A^{-1}A=E$. Обратная матрица определена только у квадратных матриц. Если обратная матрица существует, то она единственна. К обратным матрицам мы вернёмся в процессе рассмотрения теории определителей (см. \mref{det}).
  %\end{define}
  
\newpage
\subsection{Ранг матрицы}

\begin{define}
  \emph{Рангом матрицы} называется ранг системы её столбцов.\index{ранг!матрицы}
\end{define}

\begin{theorem}[о ранге матрицы]\index{теорема!о ранге матрицы}
  Ранг системы столбцов матрицы равен рангу системы её строк и равен числу ненулевых строк в её ступенчатом виде.
\end{theorem}

\begin{proof}
  Для доказательства этой теоремы докажем несколько вспомогательных утверждений.
  
  \begin{lemma}
    При ЭП строк матрицы ранг системы стоблцов не меняется.
  \end{lemma}
  {
  \renewcommand\proofname{\quad\,\,$\blacktriangleright$\!}
  \renewcommand\qedsymbol{$\blacktriangleleft$\!}
  \begin{proof}
    Если какая-то система столбцов была линейно зависима, то и преобразованная система столбцов остаётся линейно зависимой. Тогда сохраняется и линейная независимость столбцов. В таком случае базис исходной системы эквивалентен базису новой системы, таким образом они имеют одинаковое число векторов. Ранг системы векторов не изменяется.
  \end{proof}
  }
  \begin{lemma}
    При ЭП строк матрицы ранг системы строк не меняется.
  \end{lemma}
  {
  \renewcommand\proofname{\quad\,\,$\blacktriangleright$\!}
  \renewcommand\qedsymbol{$\blacktriangleleft$\!}
  \begin{proof}
    Если система строк имела базис, то и любая система, состоящая из линейных комбинаций этих строк будет иметь такой же базис (как один из возможных вариантов).
  \end{proof}
  }
  
  Приведём матрицу к сильноступенчатому виду. Теперь очевидно, что ранг системы строк равен числу ненулевых строк в ступенчатом виде (т.е. числу <<ступенек>> или главных элементов) и равен рангу системы столбцов.
\end{proof}

Очевидно, что если $C=AB$, то столбцы (строки) $C$ являются линейной комбинацией столбцов $A$ (строк $B$). В таком случае понятно, что если система столбцов $A$ была линейно независима, то и система столбцов $C$ будет также линейно независимой и если система строк $B$ была линейно независима, то и система строк $C$ будет линейно независимой.\index{ранг!произведения матриц}

Таким образом получаем $\rk (AB)\le\min(\rk A, \rk B)$. Если $B$ -- невырожденная матрица, то $\rk A=\rk (AB)$.\index{матрица!невырожденная}
